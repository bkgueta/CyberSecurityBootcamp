
## Solution Guide: Executing Exploits
In this activity, you explored three specific web vulnerabilities from a practical standpoint. 

---

For the following activities, use Azure to launch the Web Vulnerabilities VM and log in using the following credentials:

   - Username: `azadmin`
   - Password: `p4ssw0rd*`

### Parameter Tampering

1. Launch Kali Linux and owaspbwa (OWASP Broken Web Apps).
   
2. In Kali, use a web browser and navigate to the owaspbwa webpage by typing the IP address of owaspbwa into the URL.
   
      - Use `ifconfig` from the owaspbwa machine or find its IP in the welcome message in the terminal.
   - The domain you navigate to should resemble `http://172.16.203.141/`. 

3. Once the owaspbwa webpage loads, select Webgoat.
   
    - Username: `guest`
    - Password: `guest`
      
- Do the following:
   - On the left-hand side of the webpage, click **Parameter Tampering**.
   - Click **Exploit Hidden Fields**.
      
4.  Download the [Firefox extension Hack The Form](https://addons.mozilla.org/en-US/firefox/addon/form-hack/). This will install an icon that looks like a dolphin on the Firefox toolbar.

5. Reveal the hidden form fields. 
   - Click on the **Hack this Form** dolphin icon to reveal the hidden form fields.

6. Change the dollar amount to 0.99.
   
   - The sales price should change and the system should respond with "Your total price is: $0.99." 

7. What is one mitigation strategy you can deploy to defend against this type of attack?

   Possible solutions include:

   - Whitelisting, allows expected data only.
   
   - Blacklisting, blocks all unexpected data, but is highly susceptible to mistakes and is inefficient.
   
   - Restrict numeric ranges, character sequence and patterns, and use of `Null`.
   
   - Restrict parameter use of unused form fields.

   
 ### Path or (Directory) Traversal
   
In this attack, user-supplied input is passed to file system APIs.
 
1. Launch Kali Linux and owaspbwa.
   
2. In Kali, use a web browser and navigate to the owaspbwa webpage by typing the IP address of owaspbwa into the URL.
   
3. Once the webpage loads, select bWapp.
      
   - Log into bWapp with the following credentials: 
   
      - Username: `bee`
      - Password: `bug`

4. In the  **Choose Your Bug** box window, scroll down and select **Directory Traversal - Files**, and press **Hack**.
      
   - You will see a message that says "Try to climb higher Spidy!"

5. Modify the URL by injecting a dot-dot-slash.
      
   - Replace the `message.txt` with the following dot-dot-slash sequence after the `page=` portion of the URL:
      - `../../../../../../../../etc/passwd`
      
      You will see the contents of the `/etc/passwd` file.
     
6.  Name one method that you could use to help mitigate this type of threat.

      Possible solutions include:

      - Input validation, the primary defense mechanism. 
         
      - System hardening ensures that all files and folders on the local server have proper access controls in place.
         
      - Web developers should avoid storing private sensitive information in the web root directory.
   

### Cross-Site Scripting (Stored XSS)

1. In two separate windows:

   - Launch Kali Linux and owaspbwa.

#### Setup

2. Using a web browser in Kali Linux, navigate to the owaspbwa webpage by typing the IP address of the web page into the URL.
      
3. Once the webpage loads, select DVWA and log in with the following credentials: 
   
   - Username: `admin`
   - Password: `admin`
   
4. Select **Setup** and click on **Create / Reset Database**.
   
      - Select **DVWA Security** and change the setting to **Low**.
   
      - Select **XSS Stored**.
   
5. Perform a test to see if the site is vulnerable to attack.
   
   - In the **Name** field, type `TEST`.
   
   - In the **Message** field, type the following JavaScript:
   
      - `<script>alert("Hello!");</script>`
      
   - Click **Sign Guestbook**, then click **OK** on the box that pops up. 
               
      - The pop-up box indicates that this particular website is vulnerable to attack.
   
#### Attack

6. Now that you know the attack is possible, you can move forward with the exploit.

   In Kali, steal the **session ID or cookie** of an unsuspecting user who visits the webpage infected with the malicious script.


   - In the **Name** field, type `Hacked!`
   
   - In the **Message** field, type the following JavaScript:

      - `<script>alert(document.cookie);</script>`
      
      - Click **Sign Guestbook**, then click **OK** on the box that pops up and says "Hello!"
               
   - Another pop-up window will display cookie information for Kali Linux.
   
      - This proves the hack worked and that the back end database is susceptible to this attack.
      
      - From now on, whenever a guest lands on this webpage and signs the guestbook, their cookie information will be displayed.

7. Acting now as the victim, log back into the Kali machine and navigate to the owaspbwa DVWM webpage and click **XSS Stored**.

   -  Enter the name `Visitor` and the message `Glad to be here!`

      - Click **Sign Guestbook** and then click **OK** on the box that pops up and says "Hello!"
   
    - A new pop-up window displays the cookie information of the victim's (Kali) machine. This should reveal the victim's session ID: `PHPSESSID=mps4qd8ma0dnr0qhhf59cpocu3`.

---

Â© 2020 Trilogy Education Services, a 2U, Inc. brand. All Rights Reserved.  
